---
layout: publication
title: 'Unbundle-rewrite-rebundle: Runtime Detection And Rewriting Of Privacy-harming
  Code In Javascript Bundles'
authors: Mir Masood Ali, Peter Snyder, Chris Kanich, Hamed Haddadi
conference: Proceedings of the 2024 on ACM SIGSAC Conference on Computer and Communications
  Security
year: 2024
bibkey: ali2024unbundle
citations: 0
additional_links: [{name: Paper, url: 'https://arxiv.org/abs/2405.00596'}]
tags: []
short_authors: Ali et al.
---
This work presents Unbundle-Rewrite-Rebundle (URR), a system for detecting
privacy-harming portions of bundled JavaScript code and rewriting that code at
runtime to remove the privacy-harming behavior without breaking the surrounding
code or overall application. URR is a novel solution to the problem of
JavaScript bundles, where websites pre-compile multiple code units into a
single file, making it impossible for content filters and ad-blockers to
differentiate between desired and unwanted resources. Where traditional content
filtering tools rely on URLs, URR analyzes the code at the AST level, and
replaces harmful AST sub-trees with privacy-and-functionality maintaining
alternatives.
  We present an open-sourced implementation of URR as a Firefox extension and
evaluate it against JavaScript bundles generated by the most popular bundling
system (Webpack) deployed on the Tranco 10k. We evaluate URR by precision
(1.00), recall (0.95), and speed (0.43s per script) when detecting and
rewriting three representative privacy-harming libraries often included in
JavaScript bundles, and find URR to be an effective approach to a
large-and-growing blind spot unaddressed by current privacy tools.