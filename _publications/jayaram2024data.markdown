---
layout: publication
title: Data-dependent LSH For The Earth Movers Distance
authors: Jayaram Rajesh, Waingarten Erik, Zhang Tian
conference: "Arxiv"
year: 2024
bibkey: jayaram2024data
additional_links:
  - {name: "Paper", url: "https://arxiv.org/abs/2403.05041"}
tags: ['ARXIV', 'Independent', 'LSH']
---
We give new data-dependent locality sensitive hashing schemes (LSH) for the Earth Mover's Distance (\{&#37; raw &#37;\}\\(\mathsf\{EMD\}\\)\{&#37; endraw &#37;\}), and as a result, improve the best approximation for nearest neighbor search under \{&#37; raw &#37;\}\\(\mathsf\{EMD\}\\)\{&#37; endraw &#37;\} by a quadratic factor. Here, the metric \{&#37; raw &#37;\}\\(\mathsf\{EMD\}\_s(\mathbb\{R\}^d,\ell\_p)\\)\{&#37; endraw &#37;\} consists of sets of \{&#37; raw &#37;\}\\(s\\)\{&#37; endraw &#37;\} vectors in \{&#37; raw &#37;\}\\(\mathbb\{R\}^d\\)\{&#37; endraw &#37;\}, and for any two sets \{&#37; raw &#37;\}\\(x,y\\)\{&#37; endraw &#37;\} of \{&#37; raw &#37;\}\\(s\\)\{&#37; endraw &#37;\} vectors the distance \{&#37; raw &#37;\}\\(\mathsf\{EMD\}(x,y)\\)\{&#37; endraw &#37;\} is the minimum cost of a perfect matching between \{&#37; raw &#37;\}\\(x,y\\)\{&#37; endraw &#37;\}, where the cost of matching two vectors is their \{&#37; raw &#37;\}\\(\ell\_p\\)\{&#37; endraw &#37;\} distance. Previously, Andoni, Indyk, and Krauthgamer gave a (data-independent) locality-sensitive hashing scheme for \{&#37; raw &#37;\}\\(\mathsf\{EMD\}\_s(\mathbb\{R\}^d,\ell\_p)\\)\{&#37; endraw &#37;\} when \{&#37; raw &#37;\}\\(p \in [1,2]\\)\{&#37; endraw &#37;\} with approximation \{&#37; raw &#37;\}\\(O(\log^2 s)\\)\{&#37; endraw &#37;\}. By being data-dependent, we improve the approximation to \{&#37; raw &#37;\}\\(\tilde\{O\}(\log s)\\)\{&#37; endraw &#37;\}. Our main technical contribution is to show that for any distribution \{&#37; raw &#37;\}\\(\mu\\)\{&#37; endraw &#37;\} supported on the metric \{&#37; raw &#37;\}\\(\mathsf\{EMD\}\_s(\mathbb\{R\}^d, \ell\_p)\\)\{&#37; endraw &#37;\}, there exists a data-dependent LSH for dense regions of \{&#37; raw &#37;\}\\(\mu\\)\{&#37; endraw &#37;\} which achieves approximation \{&#37; raw &#37;\}\\(\tilde\{O\}(\log s)\\)\{&#37; endraw &#37;\}, and that the data-independent LSH actually achieves a \{&#37; raw &#37;\}\\(\tilde\{O\}(\log s)\\)\{&#37; endraw &#37;\}-approximation outside of those dense regions. Finally, we show how to glue together these two hashing schemes without any additional loss in the approximation. Beyond nearest neighbor search, our data-dependent LSH also gives optimal (distributional) sketches for the Earth Mover's Distance. By known sketching lower bounds, this implies that our LSH is optimal (up to $\mathrm\{poly\}(\log \log s)$ factors) among those that collide close points with constant probability.
